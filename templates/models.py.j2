"""
Autogenerated APIS models.py module
based on {{ filename }}
"""
# pylint: disable=line-too-long too-few-public-methods
# pylint: disable=import-error import-outside-toplevel unused-import
# pylint: disable=too-many-locals too-many-statements

import reversion
from django.contrib.contenttypes.models import ContentType
from django.db import models
from apis_core.apis_entities.models import TempEntityClass
from apis_core.apis_relations.models import AbstractReification


{% for key in classes %}
@reversion.register(follow=["tempentityclass_ptr"])
class {{key|capitalize}}({{base_cls | default('TempEntityClass')}}):
    """
    {{ classes[key]['definition'] }}
    Generated from model xml
    """
{% for property, attributes in classes[key]['properties'].items() -%}
{% with dt='properties/' ~ attributes['datatype']~'.j2' -%}
{% include dt ignore missing %}
{% endwith -%}
{% endfor %}
{% endfor %}

# Reifications

{% for key, values in relations.items() -%}
{% include 'abstract_reification.j2' -%}
{% endfor %}

def construct_properties():
    """
    construct properties for all the models
    based on the relations defined in the xml
    """

    from apis_core.apis_relations.models import Property

{% for key, values in relations.items() -%}
{% include 'relation.j2' -%}
{% endfor %}

# Reification properties

{% for key, values in relations.items() -%}
{% include 'reification_property.j2' -%}
{% endfor -%}
